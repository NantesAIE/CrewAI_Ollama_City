<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>City Crisis Analyser</title>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style type="text/tailwindcss">
        @layer utilities {
            .agent-fill {
                position: absolute;
                left: 0;
                bottom: 0;
                width: 100%;
                height: 0%;
                background: #43A047;
                border-radius: 50%;
                z-index: 0;
                transition: height 2s linear;
                opacity: 0.5;
            }
            .agent.loading .agent-fill {
                height: 100%;
                transition: height 2s linear;
            }
            .agent.done .agent-fill {
                height: 100%;
                opacity: 0.8;
            }
            .agent-lines rect {
                fill: #E0E0E0;
            }
            .agent-lines rect:last-child {
                fill: #43A047;
            }
        }
    </style>
</head>
<body class="h-screen m-0 font-sans bg-[#F4F6FB] overflow-hidden">
    <main class="flex flex-col h-screen gap-2 p-2 box-border font-sans bg-[#F4F6FB] md:flex-row">
        <!-- Left Panel -->
        <section class="flex flex-col gap-6 bg-[#E3F2FD] rounded-[16px] shadow-[0_2px_8px_rgba(30,42,70,0.07)] p-6 items-center flex-1 min-w-[220px] md:w-full">
            <div id="dragDropArea" class="relative w-full min-h-[180px] border-2 border-dashed border-[#90CAF9] rounded-[12px] flex justify-center items-center bg-[#f7fbff] cursor-pointer group" tabindex="0" aria-label="Zone de dépôt d'images">
                <p id="dragDropText" class="text-[#1976D2] text-[1.1rem] text-center m-0 absolute w-full left-0 top-1/2 transform -translate-y-1/2 pointer-events-none">Déposez ou sélectionnez une image</p>
            </div>
            <input type="file" id="fileInput" accept=".jpg,image/jpeg" class="hidden">
            <p id="imageError" class="text-[#d32f2f] hidden font-bold my-[0.5em] mx-0">Une image est nécessaire pour lancer l'analyse.</p>
            <button id="runAnalysis" class="py-[12px] px-[28px] bg-[#1976D2] text-white border-none rounded-[8px] text-[1.1rem] font-[500] cursor-pointer shadow-[0_1px_4px_rgba(30,42,70,0.08)] transition-background duration-200 hover:bg-[#1565C0] focus:bg-[#1565C0] focus:outline-none">Lancer l'analyse</button>
            <div class="grid grid-cols-2 grid-rows-3 gap-4 justify-center" aria-label="Images prédéfinies">
                <img src="/static/images/inondation.jpg" alt="inondation" class="w-52 h-32 rounded-[8px] object-cover cursor-pointer border-2 border-transparent transition-border-color duration-200 hover:border-[#1976D2] focus:border-[#1976D2] focus:outline-none" tabindex="0">
                <img src="/static/images/incendie.jpg" alt="Incendie" class="w-52 h-32 rounded-[8px] object-cover cursor-pointer border-2 border-transparent transition-border-color duration-200 hover:border-[#1976D2] focus:border-[#1976D2] focus:outline-none" tabindex="0">
                <img src="/static/images/eboulement.jpg" alt="Eboulement" class="w-52 h-32 rounded-[8px] object-cover cursor-pointer border-2 border-transparent transition-border-color duration-200 hover:border-[#1976D2] focus:border-[#1976D2] focus:outline-none" tabindex="0">
                <img src="/static/images/batiments.jpg" alt="Batiments" class="w-52 h-32 rounded-[8px] object-cover cursor-pointer border-2 border-transparent transition-border-color duration-200 hover:border-[#1976D2] focus:border-[#1976D2] focus:outline-none" tabindex="0">
                <img src="/static/images/Lac.jpg" alt="Lac" class="w-52 h-32 rounded-[8px] object-cover cursor-pointer border-2 border-transparent transition-border-color duration-200 hover:border-[#1976D2] focus:border-[#1976D2] focus:outline-none" tabindex="0">
                <img src="/static/images/RuePassante.jpg" alt="RuePassante" class="w-52 h-32 rounded-[8px] object-cover cursor-pointer border-2 border-transparent transition-border-color duration-200 hover:border-[#1976D2] focus:border-[#1976D2] focus:outline-none" tabindex="0">
                <button class="absolute top-2 right-2 bg-[#1976D2] text-white rounded-full w-7 h-7 items-center justify-center z-10 hover:bg-[#43A047] transition duration-200 focus:outline-none hidden group-hover:flex remove-btn" aria-label="Supprimer l'image">
                    &times;
                </button>
            </div>
        </section>

        <!-- Middle Panel -->
        <section class="flex flex-row justify-around items-center flex-1 min-w-[220px] bg-[#F9FAFB] rounded-[16px] shadow-[0_2px_8px_rgba(30,42,70,0.07)] p-6 relative md:w-full">
            <div class="flex flex-col justify-center items-center h-full">
                <div class="relative overflow-hidden w-[100px] h-[100px] bg-white rounded-full flex justify-center items-center text-center font-[600] text-[#1976D2] shadow-[0_2px_8px_rgba(30,42,70,0.07)] text-[0.95rem] cursor-pointer transition-background duration-200 hover:bg-[#1976D2] hover:text-white focus:bg-[#1976D2] focus:text-white focus:outline-none z-[1] border-2 border-[#E3F2FD]" id="equipe">
                    Orchestrateur
                </div>
            </div>
            <div class="flex flex-col items-center gap-[2.5rem] h-full justify-center">
                <div class="relative overflow-hidden w-[100px] h-[100px] bg-white rounded-full flex justify-center items-center text-center font-[600] text-[#1976D2] shadow-[0_2px_8px_rgba(30,42,70,0.07)] text-[0.95rem] cursor-pointer transition-background duration-200 hover:bg-[#1976D2] hover:text-white focus:bg-[#1976D2] focus:text-white focus:outline-none z-[1] border-2 border-[#E3F2FD]" id="agent1">
                    <div class="agent-fill"></div>
                    Vision analyst
                </div>
                <div class="relative overflow-hidden w-[100px] h-[100px] bg-white rounded-full flex justify-center items-center text-center font-[600] text-[#1976D2] shadow-[0_2px_8px_rgba(30,42,70,0.07)] text-[0.95rem] cursor-pointer transition-background duration-200 hover:bg-[#1976D2] hover:text-white focus:bg-[#1976D2] focus:text-white focus:outline-none z-[1] border-2 border-[#E3F2FD]" id="agent2">
                    <div class="agent-fill"></div>
                    Situation interpreter
                </div>
                <div class="relative overflow-hidden w-[100px] h-[100px] bg-white rounded-full flex justify-center items-center text-center font-[600] text-[#1976D2] shadow-[0_2px_8px_rgba(30,42,70,0.07)] text-[0.95rem] cursor-pointer transition-background duration-200 hover:bg-[#1976D2] hover:text-white focus:bg-[#1976D2] focus:text-white focus:outline-none z-[1] border-2 border-[#E3F2FD]" id="agent3">
                    <div class="agent-fill"></div>
                    Protocol mapper
                </div>
                <div class="relative overflow-hidden w-[100px] h-[100px] bg-white rounded-full flex justify-center items-center text-center font-[600] text-[#1976D2] shadow-[0_2px_8px_rgba(30,42,70,0.07)] text-[0.95rem] cursor-pointer transition-background duration-200 hover:bg-[#1976D2] hover:text-white focus:bg-[#1976D2] focus:text-white focus:outline-none z-[1] border-2 border-[#E3F2FD]" id="agent4">
                    <div class="agent-fill"></div>
                    Intervention planner
                </div>
            </div>
            <svg id="agent-lines" class="absolute top-0 left-0 w-full h-full pointer-events-none z-0"></svg>
        </section>

        <!-- Right Panel -->
        <section class="flex flex-col gap-6 bg-[#F1F8E9] rounded-[16px] shadow-[0_2px_8px_rgba(30,42,70,0.07)] p-6 flex-1 min-w-[220px] md:w-full h-full">
          <div id="agentResponse" class="bg-white p-[1.2rem] rounded-[8px] shadow-[0_1px_4px_rgba(30,42,70,0.08)] text-[1rem] text-[#333] break-words flex-1 flex flex-col min-h-0 h-full overflow-hidden" aria-live="polite">
            <div id="accordion-agents" class="divide-y divide-gray-200 flex-1 min-h-0 h-full overflow-y-auto">
              <!-- Vision Analyst -->
              <div>
                <h2 id="accordion-heading-vision">
                  <button type="button"
                    class="flex items-center justify-between w-full p-4 font-semibold text-[#1976D2] border border-b-0 border-gray-200 rounded-t-lg focus:ring-2 focus:ring-blue-200 hover:bg-blue-50 gap-3"
                    data-accordion-target="#accordion-body-vision"
                    aria-expanded="true"
                    aria-controls="accordion-body-vision">
                    <span>Vision Analyst</span>
                    <svg data-accordion-icon class="w-4 h-4 rotate-180 shrink-0 transition-transform" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 6">
                      <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5 5 1 1 5"/>
                    </svg>
                  </button>
                </h2>
                <div id="accordion-body-vision" class="" aria-labelledby="accordion-heading-vision">
                  <div class="p-4 border border-t-0 border-gray-200">
                    <div id="content-vision" class="text-gray-700 prose"></div>
                  </div>
                </div>
              </div>
              <!-- Situation Interpreter -->
              <div>
                <h2 id="accordion-heading-situation">
                  <button type="button"
                    class="flex items-center justify-between w-full p-4 font-semibold text-[#1976D2] border border-b-0 border-gray-200 focus:ring-2 focus:ring-blue-200 hover:bg-blue-50 gap-3"
                    data-accordion-target="#accordion-body-situation"
                    aria-expanded="false"
                    aria-controls="accordion-body-situation">
                    <span>Situation Interpreter</span>
                    <svg data-accordion-icon class="w-4 h-4 shrink-0 transition-transform" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 6">
                      <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5 5 1 1 5"/>
                    </svg>
                  </button>
                </h2>
                <div id="accordion-body-situation" class="hidden" aria-labelledby="accordion-heading-situation">
                  <div class="p-4 border border-t-0 border-gray-200">
                    <div id="content-situation" class="text-gray-700 prose"></div>
                  </div>
                </div>
              </div>
              <!-- Protocol Mapper -->
              <div>
                <h2 id="accordion-heading-protocol">
                  <button type="button"
                    class="flex items-center justify-between w-full p-4 font-semibold text-[#1976D2] border border-b-0 border-gray-200 focus:ring-2 focus:ring-blue-200 hover:bg-blue-50 gap-3"
                    data-accordion-target="#accordion-body-protocol"
                    aria-expanded="false"
                    aria-controls="accordion-body-protocol">
                    <span>Protocol Mapper</span>
                    <svg data-accordion-icon class="w-4 h-4 shrink-0 transition-transform" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 6">
                      <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5 5 1 1 5"/>
                    </svg>
                  </button>
                </h2>
                <div id="accordion-body-protocol" class="hidden" aria-labelledby="accordion-heading-protocol">
                  <div class="p-4 border border-t-0 border-gray-200">
                    <div id="content-protocol" class="text-gray-700 prose"></div>
                  </div>
                </div>
              </div>
              <!-- Intervention Planner -->
              <div>
                <h2 id="accordion-heading-intervention">
                  <button type="button"
                    class="flex items-center justify-between w-full p-4 font-semibold text-[#1976D2] border border-gray-200 focus:ring-2 focus:ring-blue-200 hover:bg-blue-50 gap-3"
                    data-accordion-target="#accordion-body-intervention"
                    aria-expanded="false"
                    aria-controls="accordion-body-intervention">
                    <span>Intervention Planner</span>
                    <svg data-accordion-icon class="w-4 h-4 shrink-0 transition-transform" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 6">
                      <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5 5 1 1 5"/>
                    </svg>
                  </button>
                </h2>
                <div id="accordion-body-intervention" class="hidden" aria-labelledby="accordion-heading-intervention">
                  <div class="p-4 border border-t-0 border-gray-200">
                    <div id="content-intervention" class="text-gray-700 prose"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>
    </main>
    <script src="/static/js/script.js"></script>
</body>
</html>
